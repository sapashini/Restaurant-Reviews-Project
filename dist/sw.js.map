{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/sw.js"],"names":[],"mappings":"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","file":"sw.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","/*\r\n* I like to acknoledge the inspiration and guide from MWS Restaurant Reviews Project\r\nA Walkthrough by Alexandro Perez.\r\n*/\r\n\r\nconst appName = \"restaurant-reviews-app\"\r\n// Create a chache variable for recycling of chaches.\r\nconst staticCacheName = appName + \"-v1.0\";\r\n\r\n// Create cache for magery.\r\nconst contentImgsCache = appName + \"-images\";\r\n\r\n// Array for the chache.\r\nvar allCaches = [\r\n  staticCacheName,\r\n  contentImgsCache\r\n];\r\n\r\n// Cache all your static assets,at Service Worker Install time.\r\nself.addEventListener('install', function(event) {\r\n  event.waitUntil(\r\n    caches.open(staticCacheName).then(function(cache) {\r\n      return cache.addAll([\r\n        '/',\r\n        '/restaurant.html',\r\n        '/css/styles.css',\r\n        '/css/styles-medium.css',\r\n        '/css/styles-large.css',\r\n        //'/js/dbhelper.js',\r\n        //'/js/secret.js',\r\n        '/js/main.js',\r\n        '/js/restaurant_info.js',\r\n        //'/js/register-sw.js',\r\n        '/data/restaurants.json'\r\n      ]);\r\n    })\r\n  );\r\n});\r\n\r\n// On activate, delete any old static cache if its name changes.\r\nself.addEventListener('activate', function(event) {\r\n  event.waitUntil(\r\n    caches.keys().then(function(cacheNames) {\r\n      return Promise.all(\r\n        cacheNames.filter(function(cacheName) {\r\n          return cacheName.startsWith(appName) &&\r\n                 !allCaches.includes(cacheName);\r\n        }).map(function(cacheName) {\r\n          return caches.delete(cacheName);\r\n        })\r\n      );\r\n    })\r\n  );\r\n});\r\n\r\n// Add a fetch listener to the sw.js file to responds to cache, falling back to network.\r\nself.addEventListener('fetch', function(event) {\r\n  const requestUrl = new URL(event.request.url);\r\n\r\n  // only highjack request made to our app (not mapbox maps or leaflet, for example)\r\n  if (requestUrl.origin === location.origin) {\r\n\r\n    // Since requests made to restaurant.html have search params (like ?id=1), the url can't be used as the\r\n    // key to access the cache, so just respondWith restaurant.html if pathname startsWith '/restaurant.html'\r\n    if (requestUrl.pathname.startsWith('/restaurant.html')) {\r\n      event.respondWith(caches.match('/restaurant.html'));\r\n      return; // Done handling request, so exit early.\r\n    }\r\n\r\n    // If the request pathname starts with /img, then we need to handle images.\r\n    if (requestUrl.pathname.startsWith('/img')) {\r\n      event.respondWith(serveImage(event.request));\r\n      return; // Done handling request, so exit early.\r\n    }\r\n  }\r\n\r\n // Default behavior: respond with cached elements, if any, falling back to network.\r\nevent.respondWith(\r\n\tcaches.match(event.request).then(function(response) {\r\n\t\treturn response || fetch(event.request);\r\n    })\r\n  );\r\n});\r\n\r\nfunction serveImage(request) {\r\n  let imageStorageUrl = request.url;\r\n\r\n  // Make a new URL with a stripped suffix and extension from the request url\r\n  // i.e. /img/1-medium.jpg  will become  /img/1\r\n  // we'll use this as the KEY for storing image into cache\r\n  imageStorageUrl = imageStorageUrl.replace(/-small\\.\\w{3}|-medium\\.\\w{3}|-large\\.\\w{3}/i, '');\r\n\r\n  return caches.open(contentImgsCache).then(function(cache) {\r\n    return cache.match(imageStorageUrl).then(function(response) {\r\n      // if image is in cache, return it, else fetch from network, cache a clone, then return network response\r\n      return response || fetch(request).then(function(networkResponse) {\r\n        cache.put(imageStorageUrl, networkResponse.clone());\r\n        return networkResponse;\r\n      });\r\n    });\r\n  });\r\n}"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvc3cuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBOzs7O0FBS0EsSUFBTSxPQUFPLEdBQUcsd0JBQWhCLEMsQ0FDQTs7QUFDQSxJQUFNLGVBQWUsR0FBRyxPQUFPLEdBQUcsT0FBbEMsQyxDQUVBOztBQUNBLElBQU0sZ0JBQWdCLEdBQUcsT0FBTyxHQUFHLFNBQW5DLEMsQ0FFQTs7QUFDQSxJQUFJLFNBQVMsR0FBRyxDQUNkLGVBRGMsRUFFZCxnQkFGYyxDQUFoQixDLENBS0E7O0FBQ0EsSUFBSSxDQUFDLGdCQUFMLENBQXNCLFNBQXRCLEVBQWlDLFVBQVMsS0FBVCxFQUFnQjtBQUMvQyxFQUFBLEtBQUssQ0FBQyxTQUFOLENBQ0UsTUFBTSxDQUFDLElBQVAsQ0FBWSxlQUFaLEVBQTZCLElBQTdCLENBQWtDLFVBQVMsS0FBVCxFQUFnQjtBQUNoRCxXQUFPLEtBQUssQ0FBQyxNQUFOLENBQWEsQ0FDbEIsR0FEa0IsRUFFbEIsa0JBRmtCLEVBR2xCLGlCQUhrQixFQUlsQix3QkFKa0IsRUFLbEIsdUJBTGtCLEVBTWxCO0FBQ0E7QUFDQSxpQkFSa0IsRUFTbEIsd0JBVGtCLEVBVWxCO0FBQ0EsNEJBWGtCLENBQWIsQ0FBUDtBQWFELEdBZEQsQ0FERjtBQWlCRCxDQWxCRCxFLENBb0JBOztBQUNBLElBQUksQ0FBQyxnQkFBTCxDQUFzQixVQUF0QixFQUFrQyxVQUFTLEtBQVQsRUFBZ0I7QUFDaEQsRUFBQSxLQUFLLENBQUMsU0FBTixDQUNFLE1BQU0sQ0FBQyxJQUFQLEdBQWMsSUFBZCxDQUFtQixVQUFTLFVBQVQsRUFBcUI7QUFDdEMsV0FBTyxPQUFPLENBQUMsR0FBUixDQUNMLFVBQVUsQ0FBQyxNQUFYLENBQWtCLFVBQVMsU0FBVCxFQUFvQjtBQUNwQyxhQUFPLFNBQVMsQ0FBQyxVQUFWLENBQXFCLE9BQXJCLEtBQ0EsQ0FBQyxTQUFTLENBQUMsUUFBVixDQUFtQixTQUFuQixDQURSO0FBRUQsS0FIRCxFQUdHLEdBSEgsQ0FHTyxVQUFTLFNBQVQsRUFBb0I7QUFDekIsYUFBTyxNQUFNLENBQUMsTUFBUCxDQUFjLFNBQWQsQ0FBUDtBQUNELEtBTEQsQ0FESyxDQUFQO0FBUUQsR0FURCxDQURGO0FBWUQsQ0FiRCxFLENBZUE7O0FBQ0EsSUFBSSxDQUFDLGdCQUFMLENBQXNCLE9BQXRCLEVBQStCLFVBQVMsS0FBVCxFQUFnQjtBQUM3QyxNQUFNLFVBQVUsR0FBRyxJQUFJLEdBQUosQ0FBUSxLQUFLLENBQUMsT0FBTixDQUFjLEdBQXRCLENBQW5CLENBRDZDLENBRzdDOztBQUNBLE1BQUksVUFBVSxDQUFDLE1BQVgsS0FBc0IsUUFBUSxDQUFDLE1BQW5DLEVBQTJDO0FBRXpDO0FBQ0E7QUFDQSxRQUFJLFVBQVUsQ0FBQyxRQUFYLENBQW9CLFVBQXBCLENBQStCLGtCQUEvQixDQUFKLEVBQXdEO0FBQ3RELE1BQUEsS0FBSyxDQUFDLFdBQU4sQ0FBa0IsTUFBTSxDQUFDLEtBQVAsQ0FBYSxrQkFBYixDQUFsQjtBQUNBLGFBRnNELENBRTlDO0FBQ1QsS0FQd0MsQ0FTekM7OztBQUNBLFFBQUksVUFBVSxDQUFDLFFBQVgsQ0FBb0IsVUFBcEIsQ0FBK0IsTUFBL0IsQ0FBSixFQUE0QztBQUMxQyxNQUFBLEtBQUssQ0FBQyxXQUFOLENBQWtCLFVBQVUsQ0FBQyxLQUFLLENBQUMsT0FBUCxDQUE1QjtBQUNBLGFBRjBDLENBRWxDO0FBQ1Q7QUFDRixHQWxCNEMsQ0FvQjlDOzs7QUFDRCxFQUFBLEtBQUssQ0FBQyxXQUFOLENBQ0MsTUFBTSxDQUFDLEtBQVAsQ0FBYSxLQUFLLENBQUMsT0FBbkIsRUFBNEIsSUFBNUIsQ0FBaUMsVUFBUyxRQUFULEVBQW1CO0FBQ25ELFdBQU8sUUFBUSxJQUFJLEtBQUssQ0FBQyxLQUFLLENBQUMsT0FBUCxDQUF4QjtBQUNHLEdBRkosQ0FERDtBQUtDLENBMUJEOztBQTRCQSxTQUFTLFVBQVQsQ0FBb0IsT0FBcEIsRUFBNkI7QUFDM0IsTUFBSSxlQUFlLEdBQUcsT0FBTyxDQUFDLEdBQTlCLENBRDJCLENBRzNCO0FBQ0E7QUFDQTs7QUFDQSxFQUFBLGVBQWUsR0FBRyxlQUFlLENBQUMsT0FBaEIsQ0FBd0IsNkNBQXhCLEVBQXVFLEVBQXZFLENBQWxCO0FBRUEsU0FBTyxNQUFNLENBQUMsSUFBUCxDQUFZLGdCQUFaLEVBQThCLElBQTlCLENBQW1DLFVBQVMsS0FBVCxFQUFnQjtBQUN4RCxXQUFPLEtBQUssQ0FBQyxLQUFOLENBQVksZUFBWixFQUE2QixJQUE3QixDQUFrQyxVQUFTLFFBQVQsRUFBbUI7QUFDMUQ7QUFDQSxhQUFPLFFBQVEsSUFBSSxLQUFLLENBQUMsT0FBRCxDQUFMLENBQWUsSUFBZixDQUFvQixVQUFTLGVBQVQsRUFBMEI7QUFDL0QsUUFBQSxLQUFLLENBQUMsR0FBTixDQUFVLGVBQVYsRUFBMkIsZUFBZSxDQUFDLEtBQWhCLEVBQTNCO0FBQ0EsZUFBTyxlQUFQO0FBQ0QsT0FIa0IsQ0FBbkI7QUFJRCxLQU5NLENBQVA7QUFPRCxHQVJNLENBQVA7QUFTRCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8qXHJcbiogSSBsaWtlIHRvIGFja25vbGVkZ2UgdGhlIGluc3BpcmF0aW9uIGFuZCBndWlkZSBmcm9tIE1XUyBSZXN0YXVyYW50IFJldmlld3MgUHJvamVjdFxyXG5BIFdhbGt0aHJvdWdoIGJ5IEFsZXhhbmRybyBQZXJlei5cclxuKi9cclxuXHJcbmNvbnN0IGFwcE5hbWUgPSBcInJlc3RhdXJhbnQtcmV2aWV3cy1hcHBcIlxyXG4vLyBDcmVhdGUgYSBjaGFjaGUgdmFyaWFibGUgZm9yIHJlY3ljbGluZyBvZiBjaGFjaGVzLlxyXG5jb25zdCBzdGF0aWNDYWNoZU5hbWUgPSBhcHBOYW1lICsgXCItdjEuMFwiO1xyXG5cclxuLy8gQ3JlYXRlIGNhY2hlIGZvciBtYWdlcnkuXHJcbmNvbnN0IGNvbnRlbnRJbWdzQ2FjaGUgPSBhcHBOYW1lICsgXCItaW1hZ2VzXCI7XHJcblxyXG4vLyBBcnJheSBmb3IgdGhlIGNoYWNoZS5cclxudmFyIGFsbENhY2hlcyA9IFtcclxuICBzdGF0aWNDYWNoZU5hbWUsXHJcbiAgY29udGVudEltZ3NDYWNoZVxyXG5dO1xyXG5cclxuLy8gQ2FjaGUgYWxsIHlvdXIgc3RhdGljIGFzc2V0cyxhdCBTZXJ2aWNlIFdvcmtlciBJbnN0YWxsIHRpbWUuXHJcbnNlbGYuYWRkRXZlbnRMaXN0ZW5lcignaW5zdGFsbCcsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgZXZlbnQud2FpdFVudGlsKFxyXG4gICAgY2FjaGVzLm9wZW4oc3RhdGljQ2FjaGVOYW1lKS50aGVuKGZ1bmN0aW9uKGNhY2hlKSB7XHJcbiAgICAgIHJldHVybiBjYWNoZS5hZGRBbGwoW1xyXG4gICAgICAgICcvJyxcclxuICAgICAgICAnL3Jlc3RhdXJhbnQuaHRtbCcsXHJcbiAgICAgICAgJy9jc3Mvc3R5bGVzLmNzcycsXHJcbiAgICAgICAgJy9jc3Mvc3R5bGVzLW1lZGl1bS5jc3MnLFxyXG4gICAgICAgICcvY3NzL3N0eWxlcy1sYXJnZS5jc3MnLFxyXG4gICAgICAgIC8vJy9qcy9kYmhlbHBlci5qcycsXHJcbiAgICAgICAgLy8nL2pzL3NlY3JldC5qcycsXHJcbiAgICAgICAgJy9qcy9tYWluLmpzJyxcclxuICAgICAgICAnL2pzL3Jlc3RhdXJhbnRfaW5mby5qcycsXHJcbiAgICAgICAgLy8nL2pzL3JlZ2lzdGVyLXN3LmpzJyxcclxuICAgICAgICAnL2RhdGEvcmVzdGF1cmFudHMuanNvbidcclxuICAgICAgXSk7XHJcbiAgICB9KVxyXG4gICk7XHJcbn0pO1xyXG5cclxuLy8gT24gYWN0aXZhdGUsIGRlbGV0ZSBhbnkgb2xkIHN0YXRpYyBjYWNoZSBpZiBpdHMgbmFtZSBjaGFuZ2VzLlxyXG5zZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ2FjdGl2YXRlJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICBldmVudC53YWl0VW50aWwoXHJcbiAgICBjYWNoZXMua2V5cygpLnRoZW4oZnVuY3Rpb24oY2FjaGVOYW1lcykge1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5hbGwoXHJcbiAgICAgICAgY2FjaGVOYW1lcy5maWx0ZXIoZnVuY3Rpb24oY2FjaGVOYW1lKSB7XHJcbiAgICAgICAgICByZXR1cm4gY2FjaGVOYW1lLnN0YXJ0c1dpdGgoYXBwTmFtZSkgJiZcclxuICAgICAgICAgICAgICAgICAhYWxsQ2FjaGVzLmluY2x1ZGVzKGNhY2hlTmFtZSk7XHJcbiAgICAgICAgfSkubWFwKGZ1bmN0aW9uKGNhY2hlTmFtZSkge1xyXG4gICAgICAgICAgcmV0dXJuIGNhY2hlcy5kZWxldGUoY2FjaGVOYW1lKTtcclxuICAgICAgICB9KVxyXG4gICAgICApO1xyXG4gICAgfSlcclxuICApO1xyXG59KTtcclxuXHJcbi8vIEFkZCBhIGZldGNoIGxpc3RlbmVyIHRvIHRoZSBzdy5qcyBmaWxlIHRvIHJlc3BvbmRzIHRvIGNhY2hlLCBmYWxsaW5nIGJhY2sgdG8gbmV0d29yay5cclxuc2VsZi5hZGRFdmVudExpc3RlbmVyKCdmZXRjaCcsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgY29uc3QgcmVxdWVzdFVybCA9IG5ldyBVUkwoZXZlbnQucmVxdWVzdC51cmwpO1xyXG5cclxuICAvLyBvbmx5IGhpZ2hqYWNrIHJlcXVlc3QgbWFkZSB0byBvdXIgYXBwIChub3QgbWFwYm94IG1hcHMgb3IgbGVhZmxldCwgZm9yIGV4YW1wbGUpXHJcbiAgaWYgKHJlcXVlc3RVcmwub3JpZ2luID09PSBsb2NhdGlvbi5vcmlnaW4pIHtcclxuXHJcbiAgICAvLyBTaW5jZSByZXF1ZXN0cyBtYWRlIHRvIHJlc3RhdXJhbnQuaHRtbCBoYXZlIHNlYXJjaCBwYXJhbXMgKGxpa2UgP2lkPTEpLCB0aGUgdXJsIGNhbid0IGJlIHVzZWQgYXMgdGhlXHJcbiAgICAvLyBrZXkgdG8gYWNjZXNzIHRoZSBjYWNoZSwgc28ganVzdCByZXNwb25kV2l0aCByZXN0YXVyYW50Lmh0bWwgaWYgcGF0aG5hbWUgc3RhcnRzV2l0aCAnL3Jlc3RhdXJhbnQuaHRtbCdcclxuICAgIGlmIChyZXF1ZXN0VXJsLnBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9yZXN0YXVyYW50Lmh0bWwnKSkge1xyXG4gICAgICBldmVudC5yZXNwb25kV2l0aChjYWNoZXMubWF0Y2goJy9yZXN0YXVyYW50Lmh0bWwnKSk7XHJcbiAgICAgIHJldHVybjsgLy8gRG9uZSBoYW5kbGluZyByZXF1ZXN0LCBzbyBleGl0IGVhcmx5LlxyXG4gICAgfVxyXG5cclxuICAgIC8vIElmIHRoZSByZXF1ZXN0IHBhdGhuYW1lIHN0YXJ0cyB3aXRoIC9pbWcsIHRoZW4gd2UgbmVlZCB0byBoYW5kbGUgaW1hZ2VzLlxyXG4gICAgaWYgKHJlcXVlc3RVcmwucGF0aG5hbWUuc3RhcnRzV2l0aCgnL2ltZycpKSB7XHJcbiAgICAgIGV2ZW50LnJlc3BvbmRXaXRoKHNlcnZlSW1hZ2UoZXZlbnQucmVxdWVzdCkpO1xyXG4gICAgICByZXR1cm47IC8vIERvbmUgaGFuZGxpbmcgcmVxdWVzdCwgc28gZXhpdCBlYXJseS5cclxuICAgIH1cclxuICB9XHJcblxyXG4gLy8gRGVmYXVsdCBiZWhhdmlvcjogcmVzcG9uZCB3aXRoIGNhY2hlZCBlbGVtZW50cywgaWYgYW55LCBmYWxsaW5nIGJhY2sgdG8gbmV0d29yay5cclxuZXZlbnQucmVzcG9uZFdpdGgoXHJcblx0Y2FjaGVzLm1hdGNoKGV2ZW50LnJlcXVlc3QpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuXHRcdHJldHVybiByZXNwb25zZSB8fCBmZXRjaChldmVudC5yZXF1ZXN0KTtcclxuICAgIH0pXHJcbiAgKTtcclxufSk7XHJcblxyXG5mdW5jdGlvbiBzZXJ2ZUltYWdlKHJlcXVlc3QpIHtcclxuICBsZXQgaW1hZ2VTdG9yYWdlVXJsID0gcmVxdWVzdC51cmw7XHJcblxyXG4gIC8vIE1ha2UgYSBuZXcgVVJMIHdpdGggYSBzdHJpcHBlZCBzdWZmaXggYW5kIGV4dGVuc2lvbiBmcm9tIHRoZSByZXF1ZXN0IHVybFxyXG4gIC8vIGkuZS4gL2ltZy8xLW1lZGl1bS5qcGcgIHdpbGwgYmVjb21lICAvaW1nLzFcclxuICAvLyB3ZSdsbCB1c2UgdGhpcyBhcyB0aGUgS0VZIGZvciBzdG9yaW5nIGltYWdlIGludG8gY2FjaGVcclxuICBpbWFnZVN0b3JhZ2VVcmwgPSBpbWFnZVN0b3JhZ2VVcmwucmVwbGFjZSgvLXNtYWxsXFwuXFx3ezN9fC1tZWRpdW1cXC5cXHd7M318LWxhcmdlXFwuXFx3ezN9L2ksICcnKTtcclxuXHJcbiAgcmV0dXJuIGNhY2hlcy5vcGVuKGNvbnRlbnRJbWdzQ2FjaGUpLnRoZW4oZnVuY3Rpb24oY2FjaGUpIHtcclxuICAgIHJldHVybiBjYWNoZS5tYXRjaChpbWFnZVN0b3JhZ2VVcmwpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgLy8gaWYgaW1hZ2UgaXMgaW4gY2FjaGUsIHJldHVybiBpdCwgZWxzZSBmZXRjaCBmcm9tIG5ldHdvcmssIGNhY2hlIGEgY2xvbmUsIHRoZW4gcmV0dXJuIG5ldHdvcmsgcmVzcG9uc2VcclxuICAgICAgcmV0dXJuIHJlc3BvbnNlIHx8IGZldGNoKHJlcXVlc3QpLnRoZW4oZnVuY3Rpb24obmV0d29ya1Jlc3BvbnNlKSB7XHJcbiAgICAgICAgY2FjaGUucHV0KGltYWdlU3RvcmFnZVVybCwgbmV0d29ya1Jlc3BvbnNlLmNsb25lKCkpO1xyXG4gICAgICAgIHJldHVybiBuZXR3b3JrUmVzcG9uc2U7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn0iXX0="}